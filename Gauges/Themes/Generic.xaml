<ResourceDictionary xmlns="http://schemas.microsoft.com/winfx/2006/xaml/presentation"
                    xmlns:x="http://schemas.microsoft.com/winfx/2006/xaml"
                    xmlns:local="clr-namespace:Gauges">

    <Style TargetType="{x:Type local:Gauge}">
        <Setter Property="Template">
            <Setter.Value>
                <ControlTemplate TargetType="{x:Type local:Gauge}">
                    <ControlTemplate.Resources>

                        <LinearGradientBrush x:Key="Brush" StartPoint="0,0" EndPoint="1,0">
                            <LinearGradientBrush.GradientStops>
                                <GradientStopCollection>
                                    <GradientStop Offset="0.0" Color="Red" />
                                    <GradientStop Offset="0.25" Color="Red" />
                                    <GradientStop Offset="0.25" Color="Green" />
                                    <GradientStop Offset="0.75" Color="Green" />
                                    <GradientStop Offset="0.75" Color="Red" />
                                    <GradientStop Offset="1.0" Color="Red" />
                                </GradientStopCollection>
                            </LinearGradientBrush.GradientStops>
                        </LinearGradientBrush>

                        <DataTemplate x:Key="CircleTemplate">
                            <Ellipse Width="10"
                                     Height="10"
                                     VerticalAlignment="Center"
                                     Fill="{Binding Foreground,
                                                    RelativeSource={RelativeSource Mode=FindAncestor,
                                                                                   AncestorType={x:Type local:Gauge}}}" />
                        </DataTemplate>
                        <DataTemplate x:Key="RectangleTemplate">
                            <Rectangle Width="5"
                                       Height="10"
                                       VerticalAlignment="Center"
                                       Fill="{Binding Foreground,
                                                      RelativeSource={RelativeSource Mode=FindAncestor,
                                                                                     AncestorType={x:Type local:Gauge}}}" />
                        </DataTemplate>
                        <DataTemplate x:Key="TriangleTemplate">
                            <!--<Path VerticalAlignment="Bottom"
                                  Data="m0,-5 5,0 10,5z"
                                  Fill="{Binding Foreground,
                                                 RelativeSource={RelativeSource Mode=FindAncestor,
                                                                                AncestorType={x:Type local:Gauge}}}" />-->
                        </DataTemplate>
                        <DataTemplate x:Key="LineTemplate">
                            <Rectangle Width="3"
                                       Height="10"
                                       VerticalAlignment="Center"
                                       Fill="{Binding Foreground,
                                                      RelativeSource={RelativeSource Mode=FindAncestor,
                                                                                     AncestorType={x:Type local:Gauge}}}" />
                        </DataTemplate>
                        <local:GaugeIndicatorConverter x:Key="GaugeShapeConverter"
                                                       Circle="{StaticResource CircleTemplate}"
                                                       Line="{StaticResource LineTemplate}"
                                                       Rectangle="{StaticResource RectangleTemplate}"
                                                       Triangle="{StaticResource TriangleTemplate}" />

                        <local:MakerDataTemplateSelector x:Key="MarkerDataTemplateSelector"
                                                         Circle="{StaticResource CircleTemplate}"
                                                         Line="{StaticResource LineTemplate}"
                                                         Rectangle="{StaticResource RectangleTemplate}"
                                                         Triangle="{StaticResource TriangleTemplate}" />


                    </ControlTemplate.Resources>
                    <Grid>
                        <Grid.RowDefinitions>
                            <RowDefinition Height="Auto" />
                            <RowDefinition x:Name="BottomRow"
                                           Height="Auto"
                                           MinHeight="{TemplateBinding MinHeight}" />
                        </Grid.RowDefinitions>
                        <Grid Grid.Row="0">
                            <Grid.RowDefinitions>
                                <RowDefinition Height="Auto" />
                                <RowDefinition Height="Auto" />
                            </Grid.RowDefinitions>
                            <local:TextTickBar Grid.Row="0"
                                               Height="20"
                                               Fill="{TemplateBinding Foreground}"
                                               Placement="Top"
                                               SnapsToDevicePixels="True"
                                               TickFrequency="25"
                                               Visibility="Visible" 
                                               FontFamily="{TemplateBinding FontFamily}"
                                               FontSize="{TemplateBinding FontSize}"
                                               FontStyle="{TemplateBinding FontStyle}"
                                               FontStretch="{TemplateBinding FontStretch}"
                                               FontWeight="{TemplateBinding FontWeight}"
                                               Minimum="{TemplateBinding Minimum}"
                                               Maximum="{TemplateBinding Maximum}" />
                            <TickBar x:Name="TopTick"
                                     Grid.Row="1"
                                     Height="15"
                                     Fill="{TemplateBinding Foreground}"
                                     VerticalAlignment="Bottom"
                                     Placement="Bottom"
                                     SnapsToDevicePixels="True"
                                     TickFrequency="25"
                                     Visibility="Visible" />
                            <TickBar Grid.Row="1"
                                     Height="10"
                                     Fill="{TemplateBinding Foreground}"
                                     VerticalAlignment="Bottom"
                                     Placement="Bottom"
                                     SnapsToDevicePixels="True"
                                     TickFrequency="10"
                                     Visibility="Visible" />
                        </Grid>
                        <Grid Grid.Row="1">
                            <Border x:Name="PART_Track"
                                    Height="8"
                                    VerticalAlignment="Center"
                                    BorderBrush="{StaticResource Brush}"
                                    BorderThickness="2"
                                    CornerRadius="2" />


                            <Grid x:Name="PART_Indicator" VerticalAlignment="Stretch">
                                <!--
                                    <TextBlock Background="White"
                                    Style="{StaticResource LabelStyle}"
                                    Text="{Binding Value,
                                    RelativeSource={RelativeSource TemplatedParent},
                                    StringFormat='{}{0:F0}'}" />
                                -->

                                <ContentPresenter Content="{TemplateBinding Marker}"
                                                  ContentTemplateSelector="{StaticResource MarkerDataTemplateSelector}" />
                                <!--
                                    <Rectangle Width="3"
                                    Height="10"
                                    VerticalAlignment="Bottom"
                                    Fill="{TemplateBinding Foreground}" />
                                -->
                            </Grid>
                        </Grid>

                    </Grid>
                </ControlTemplate>
            </Setter.Value>
        </Setter>
    </Style>
</ResourceDictionary>
